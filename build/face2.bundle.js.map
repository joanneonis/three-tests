{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./experiments/face/v2/clmtracker.js","webpack:///./experiments/face/v2/main.js","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js"],"names":["vid","document","getElementById","vid_width","width","vid_height","height","overlay","trackingStarted","ctrack","emotionData","ec","proportion","ctx","svg","margin","top","right","bottom","left","Clam","mediaCheck","reguliseEyebrows","emotionModel","emotionClassifier","init","window","getBlank","getEmotions","startbutton","value","disabled","videoWidth","videoHeight","Math","round","proportions","stream","srcObject","src","URL","createObjectURL","onloadedmetadata","adjustVideoProportions","play","onresize","stop","reset","start","alert","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","webkitURL","msURL","mozURL","mediaDevices","video","then","gumSuccess","gumFail","addEventListener","enablestart","pModel","shapeModel","nonRegularizedVectors","push","clm","tracker","useWebGL","overlayCC","getContext","videoInfo","emotionStates","startVideo","getEmotionData","getVidProportions","drawLoop","d3Vis","requestAnimationFrame","clearRect","getCurrentPosition","draw","cp","getCurrentParameters","meanPredict","updateData","i","length","style","visibility","barWidth","formatPercent","d3","format","x","scale","linear","domain","range","y","select","append","attr","selectAll","data","enter","datum","index","text","emotion","rects","texts","toFixed","exit","remove"],"mappings":"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","file":"face2.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./experiments/face/v2/main.js\");\n","var vid = document.getElementById('videoel');\nvar vid_width = vid.width;\nvar vid_height = vid.height;\nvar overlay = document.getElementById('overlay');\nvar trackingStarted;\nvar ctrack;\nvar emotionData;\nvar ec;\nvar proportion;\n\nvar ctx;\n\n// d3 Only\nvar svg;\nvar margin = {\n\ttop: 20,\n\tright: 20,\n\tbottom: 10,\n\tleft: 40\n};\nvar width = 400 - margin.left - margin.right;\nvar height = 100 - margin.top - margin.bottom;\n\nexport default class Clam {\n\tconstructor() {\n\t\t\n\t}\n\n\tstatic init() {\n\t\tctx = this;\n\t\tthis.mediaCheck();\n\t\tthis.reguliseEyebrows();\n\n\t\tdelete emotionModel['disgusted'];\n\t\tdelete emotionModel['fear'];\n\n\t\tec = new emotionClassifier();\n\t\tec.init(emotionModel);\n\t\twindow.ec = ec;\n\t\temotionData = ec.getBlank();\n\n\t\t// this.d3Vis();\n\t}\n\n\tstatic getClamTracker() {\n\t\treturn ctrack;\n\t}\n\n\tstatic getEc() {\n\t\treturn ec;\n\t}\n\n\tstatic getEmotions() {\n\t\treturn ec.getEmotions();\n\t}\n\n\tstatic getEmotionData() {\n\t\treturn emotionData;\n\t}\n\n\t/********** check and set up video/webcam **********/\n\tstatic enablestart() {\n\t\tvar startbutton = document.getElementById('startbutton');\n\t\tstartbutton.value = \"start\";\n\t\tstartbutton.disabled = null;\n\t}\n\n\tstatic adjustVideoProportions() {\n\t\t// resize overlay and video if proportions are different\n\t\t// keep same height, just change width\n\t\tproportion = vid.videoWidth / vid.videoHeight;\n\t\tvid_width = Math.round(vid_height * proportion);\n\t\tvid.width = vid_width;\n\t\toverlay.width = vid_width;\n\t}\n\n\tstatic getVidProportions() {\n\t\treturn {\n\t\t\tvideoWidth: vid_width,\n\t\t\tvideoHeight: vid_height,\n\t\t\tproportions: proportion,\n\t\t};\n\t}\n\n\tstatic gumSuccess(stream) {\n\t\t// add camera stream if getUserMedia succeeded\n\t\tif (\"srcObject\" in vid) {\n\t\t\tvid.srcObject = stream;\n\t\t} else {\n\t\t\tvid.src = (window.URL && window.URL.createObjectURL(stream));\n\t\t}\n\t\tvid.onloadedmetadata = function () {\n\t\t\tctx.adjustVideoProportions();\n\t\t\tvid.play();\n\t\t}\n\t\tvid.onresize = function () {\n\t\t\tctx.adjustVideoProportions();\n\t\t\tif (trackingStarted) {\n\t\t\t\tctrack.stop();\n\t\t\t\tctrack.reset();\n\t\t\t\tctrack.start(vid);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic gumFail() {\n\t\talert(\"There was some problem trying to fetch video from your webcam. If you have a webcam, please make sure to accept when the browser asks for access to your webcam.\");\n\t}\n\t\n\tstatic mediaCheck() {\n\t\tnavigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n\t\twindow.URL = window.URL || window.webkitURL || window.msURL || window.mozURL;\n\t\t\n\t\t// check for camerasupport\n\t\tif (navigator.mediaDevices) {\n\t\t\tnavigator.mediaDevices.getUserMedia({\n\t\t\t\tvideo: true\n\t\t\t}).then(this.gumSuccess).catch(this.gumFail);\n\t\t} else if (navigator.getUserMedia) {\n\t\t\tnavigator.getUserMedia({\n\t\t\t\tvideo: true\n\t\t\t}, this.gumSuccess, this.gumFail);\n\t\t} else {\n\t\t\talert(\"This demo depends on getUserMedia, which your browser does not seem to support. :(\");\n\t\t}\n\t\t\n\t\tvid.addEventListener('canplay', this.enablestart, false);\n\t}\n\n\t/*********** setup of emotion detection *************/\n\tstatic reguliseEyebrows() {\n\t\t// set eigenvector 9 and 11 to not be regularized. This is to better detect motion of the eyebrows\n\t\tpModel.shapeModel.nonRegularizedVectors.push(9);\n\t\tpModel.shapeModel.nonRegularizedVectors.push(11);\n\t\tctrack = new clm.tracker({\n\t\t\tuseWebGL: true\n\t\t});\n\t\tctrack.init(pModel);\n\t\ttrackingStarted = false;\n\n\t\twindow.ctrack = ctrack;\n\t}\n\n\tstatic startVideo() {\n\t\t// start video\n\t\tvid.play();\n\t\t// start tracking\n\t\tctrack.start(vid);\n\t\ttrackingStarted = true;\n\n\t\t// start loop to draw face\n\t\t// this.drawLoop();\n\t}\n\n\t// static d3Vis() {\n\t// \tvar barWidth = 30;\n\t// \tvar formatPercent = d3.format(\".0%\");\n\t// \tvar x = d3.scale.linear()\n\t// \t\t.domain([0, Clam.getEmotions().length]).range([margin.left, width + margin.left]);\n\t// \tvar y = d3.scale.linear()\n\t// \t\t.domain([0, 1]).range([0, height]);\n\t// \tsvg = d3.select(\"#emotion_chart\").append(\"svg\")\n\t// \t\t.attr(\"width\", width + margin.left + margin.right)\n\t// \t\t.attr(\"height\", height + margin.top + margin.bottom)\n\t// \tsvg.selectAll(\"rect\").\n\t// \tdata(emotionData).\n\t// \tenter().\n\t// \tappend(\"svg:rect\").\n\t// \tattr(\"x\", function (datum, index) {\n\t// \t\treturn x(index);\n\t// \t}).\n\t// \tattr(\"y\", function (datum) {\n\t// \t\treturn height - y(datum.value);\n\t// \t}).\n\t// \tattr(\"height\", function (datum) {\n\t// \t\treturn y(datum.value);\n\t// \t}).\n\t// \tattr(\"width\", barWidth).\n\t// \tattr(\"fill\", \"#2d578b\");\n\t// \tsvg.selectAll(\"text.labels\").\n\t// \tdata(emotionData).\n\t// \tenter().\n\t// \tappend(\"svg:text\").\n\t// \tattr(\"x\", function (datum, index) {\n\t// \t\treturn x(index) + barWidth;\n\t// \t}).\n\t// \tattr(\"y\", function (datum) {\n\t// \t\treturn height - y(datum.value);\n\t// \t}).\n\t// \tattr(\"dx\", -barWidth / 2).\n\t// \tattr(\"dy\", \"1.2em\").\n\t// \tattr(\"text-anchor\", \"middle\").\n\t// \ttext(function (datum) {\n\t// \t\treturn datum.value;\n\t// \t}).\n\t// \tattr(\"fill\", \"white\").\n\t// \tattr(\"class\", \"labels\");\n\t// \tsvg.selectAll(\"text.yAxis\").\n\t// \tdata(emotionData).\n\t// \tenter().append(\"svg:text\").\n\t// \tattr(\"x\", function (datum, index) {\n\t// \t\treturn x(index) + barWidth;\n\t// \t}).\n\t// \tattr(\"y\", height).\n\t// \tattr(\"dx\", -barWidth / 2).\n\t// \tattr(\"text-anchor\", \"middle\").\n\t// \tattr(\"style\", \"font-size: 12\").\n\t// \ttext(function (datum) {\n\t// \t\treturn datum.emotion;\n\t// \t}).\n\t// \tattr(\"transform\", \"translate(0, 18)\").\n\t// \tattr(\"class\", \"yAxis\");\n\n\t// }\n\n\t// static updateData(data) {\n\t// \tvar y = d3.scale.linear()\n\t// \t\t.domain([0, 1]).range([0, height]);\n\n\t// \t// update\n\t// \tif (!svg) { return; }\n\t// \tvar rects = svg.selectAll(\"rect\")\n\t// \t\t.data(data)\n\t// \t\t.attr(\"y\", function (datum) {\n\t// \t\t\treturn height - y(datum.value);\n\t// \t\t})\n\t// \t\t.attr(\"height\", function (datum) {\n\t// \t\t\treturn y(datum.value);\n\t// \t\t});\n\t// \tvar texts = svg.selectAll(\"text.labels\")\n\t// \t\t.data(data)\n\t// \t\t.attr(\"y\", function (datum) {\n\t// \t\t\treturn height - y(datum.value);\n\t// \t\t})\n\t// \t\t.text(function (datum) {\n\t// \t\t\treturn datum.value.toFixed(1);\n\t// \t\t});\n\t// \t// enter\n\t// \trects.enter().append(\"svg:rect\");\n\t// \ttexts.enter().append(\"svg:text\");\n\t// \t// exit\n\t// \trects.exit().remove();\n\t// \ttexts.exit().remove();\n\t// }\n}","import Clam from './clmtracker';\n\n// console.log(Clam.init());\nClam.init();\n\nvar overlay = document.getElementById('overlay');\nvar overlayCC = overlay.getContext('2d');\nvar videoInfo;\nvar emotionData;\nvar ctrack;\nvar ec;\n\n// d3\nvar svg;\n\nvar emotionStates;\n\ndocument.getElementById('startbutton').addEventListener('click', function () {\n\tClam.startVideo();\n\temotionData = Clam.getEmotionData();\n\tvideoInfo = Clam.getVidProportions();\n\tctrack = window.ctrack;\n\tec = window.ec;\n\tdrawLoop();\n\td3Vis();\n});\n\nfunction drawLoop() {\n\trequestAnimationFrame(drawLoop);\n\n\n\toverlayCC.clearRect(0, 0, videoInfo.videoWidth, videoInfo.videoHeight);\n\t//psrElement.innerHTML = \"score :\" + ctrack.getScore().toFixed(4);\n\tif (ctrack.getCurrentPosition()) {\n\t\tctrack.draw(overlay);\n\t}\n\tvar cp = ctrack.getCurrentParameters();\n\temotionStates = ec.meanPredict(cp);\n\n\tif (emotionStates) {\n\t\tupdateData(emotionStates);\n\t\tfor (var i = 0; i < emotionStates.length; i++) {\n\t\t\tif (emotionStates[i].value > 0.4) {\n\t\t\t\tdocument.getElementById('icon' + (i + 1)).style.visibility = 'visible';\n\t\t\t} else {\n\t\t\t\tdocument.getElementById('icon' + (i + 1)).style.visibility = 'hidden';\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n\nvar margin = {\n\t\ttop: 20,\n\t\tright: 20,\n\t\tbottom: 10,\n\t\tleft: 40\n\t},\n\twidth = 400 - margin.left - margin.right,\n\theight = 100 - margin.top - margin.bottom;\n\nvar barWidth = 30;\nvar formatPercent = d3.format(\".0%\");\n\nfunction d3Vis() {\n\tvar x = d3.scale.linear()\n\t\t.domain([0, Clam.getEmotions().length]).range([margin.left, width + margin.left]);\n\tvar y = d3.scale.linear()\n\t\t.domain([0, 1]).range([0, height]);\n\tsvg = d3.select(\"#emotion_chart\").append(\"svg\")\n\t\t.attr(\"width\", width + margin.left + margin.right)\n\t\t.attr(\"height\", height + margin.top + margin.bottom)\n\tsvg.selectAll(\"rect\").\n\tdata(emotionData).\n\tenter().\n\tappend(\"svg:rect\").\n\tattr(\"x\", function (datum, index) {\n\t\treturn x(index);\n\t}).\n\tattr(\"y\", function (datum) {\n\t\treturn height - y(datum.value);\n\t}).\n\tattr(\"height\", function (datum) {\n\t\treturn y(datum.value);\n\t}).\n\tattr(\"width\", barWidth).\n\tattr(\"fill\", \"#2d578b\");\n\tsvg.selectAll(\"text.labels\").\n\tdata(emotionData).\n\tenter().\n\tappend(\"svg:text\").\n\tattr(\"x\", function (datum, index) {\n\t\treturn x(index) + barWidth;\n\t}).\n\tattr(\"y\", function (datum) {\n\t\treturn height - y(datum.value);\n\t}).\n\tattr(\"dx\", -barWidth / 2).\n\tattr(\"dy\", \"1.2em\").\n\tattr(\"text-anchor\", \"middle\").\n\ttext(function (datum) {\n\t\treturn datum.value;\n\t}).\n\tattr(\"fill\", \"white\").\n\tattr(\"class\", \"labels\");\n\tsvg.selectAll(\"text.yAxis\").\n\tdata(emotionData).\n\tenter().append(\"svg:text\").\n\tattr(\"x\", function (datum, index) {\n\t\treturn x(index) + barWidth;\n\t}).\n\tattr(\"y\", height).\n\tattr(\"dx\", -barWidth / 2).\n\tattr(\"text-anchor\", \"middle\").\n\tattr(\"style\", \"font-size: 12\").\n\ttext(function (datum) {\n\t\treturn datum.emotion;\n\t}).\n\tattr(\"transform\", \"translate(0, 18)\").\n\tattr(\"class\", \"yAxis\");\n}\n\nfunction updateData(data) {\n\t\tvar y = d3.scale.linear()\n\t\t.domain([0, 1]).range([0, height]);\n\n\t// update\n\tvar rects = svg.selectAll(\"rect\")\n\t\t.data(data)\n\t\t.attr(\"y\", function (datum) {\n\t\t\treturn height - y(datum.value);\n\t\t})\n\t\t.attr(\"height\", function (datum) {\n\t\t\treturn y(datum.value);\n\t\t});\n\tvar texts = svg.selectAll(\"text.labels\")\n\t\t.data(data)\n\t\t.attr(\"y\", function (datum) {\n\t\t\treturn height - y(datum.value);\n\t\t})\n\t\t.text(function (datum) {\n\t\t\treturn datum.value.toFixed(1);\n\t\t});\n\t// enter\n\trects.enter().append(\"svg:rect\");\n\ttexts.enter().append(\"svg:text\");\n\t// exit\n\trects.exit().remove();\n\ttexts.exit().remove();\n} ","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;"],"sourceRoot":""}