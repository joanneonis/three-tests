{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./experiments/face/v2/clmtracker.js","webpack:///./experiments/face/v2/main.js","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js"],"names":["vid","document","getElementById","vid_width","width","vid_height","height","overlay","overlayCC","getContext","trackingStarted","ctrack","emotionData","ec","ctx","svg","margin","top","right","bottom","left","Clam","mediaCheck","reguliseEyebrows","emotionModel","emotionClassifier","init","getBlank","d3Vis","getEmotions","startbutton","value","disabled","proportion","videoWidth","videoHeight","Math","round","stream","srcObject","src","window","URL","createObjectURL","onloadedmetadata","adjustVideoProportions","play","onresize","stop","reset","start","alert","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","webkitURL","msURL","mozURL","mediaDevices","video","then","gumSuccess","gumFail","addEventListener","enablestart","pModel","shapeModel","nonRegularizedVectors","push","clm","tracker","useWebGL","requestAnimationFrame","drawLoop","clearRect","getCurrentPosition","draw","cp","getCurrentParameters","er","meanPredict","console","log","updateData","i","length","style","visibility","barWidth","formatPercent","d3","format","x","scale","linear","domain","range","y","select","append","attr","selectAll","data","enter","datum","index","text","emotion","rects","texts","toFixed","exit","remove","startVideo"],"mappings":"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KAAV,EAAiB;AACtB,eAAOA,KAAK,CAAC3E,KAAN,CAAYiF,OAAZ,CAAoB,CAApB,CAAP;AACA,OAPU,CAAZ,CAduB,CAsBvB;;AACAF,WAAK,CAACL,KAAN,GAAcJ,MAAd,CAAqB,UAArB;AACAU,WAAK,CAACN,KAAN,GAAcJ,MAAd,CAAqB,UAArB,EAxBuB,CAyBvB;;AACAS,WAAK,CAACG,IAAN,GAAaC,MAAb;AACAH,WAAK,CAACE,IAAN,GAAaC,MAAb;AACA;;;;;;;;;;;;;;;;;;AC5PF;AAAA;CAEA;;AACA7F,mDAAI,CAACK,IAAL;AAEAzB,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuC+D,gBAAvC,CAAwD,OAAxD,EAAiE,YAAY;AAC5E5C,qDAAI,CAAC8F,UAAL;AACA,CAFD,E,CAKA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,I;;;;;;;;;;;ACvGA;AACA;AACA;AACA;AACA;;AAEA,iC;;;;;;;;;;;ACNA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,8B","file":"face2.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./experiments/face/v2/main.js\");\n","var vid = document.getElementById('videoel');\nvar vid_width = vid.width;\nvar vid_height = vid.height;\nvar overlay = document.getElementById('overlay');\nvar overlayCC = overlay.getContext('2d');\nvar trackingStarted;\nvar ctrack;\nvar emotionData;\nvar ec;\n\nvar ctx;\n\n// d3 Only\nvar svg;\nvar margin = {\n\ttop: 20,\n\tright: 20,\n\tbottom: 10,\n\tleft: 40\n};\nvar width = 400 - margin.left - margin.right;\nvar height = 100 - margin.top - margin.bottom;\n\nexport default class Clam {\n\tconstructor() {\n\t\t\n\t}\n\n\tstatic init() {\n\t\tctx = this;\n\t\tthis.mediaCheck();\n\t\tthis.reguliseEyebrows();\n\n\t\tdelete emotionModel['disgusted'];\n\t\tdelete emotionModel['fear'];\n\n\t\tec = new emotionClassifier();\n\t\tec.init(emotionModel);\n\t\temotionData = ec.getBlank();\n\n\t\tthis.d3Vis();\n\t}\n\n\tstatic getEc() {\n\t\treturn ec;\n\t}\n\n\tstatic getEmotions() {\n\t\treturn ec.getEmotions();\n\t}\n\n\tstatic getEmotionData() {\n\t\treturn emotionData;\n\t}\n\n\t/********** check and set up video/webcam **********/\n\tstatic enablestart() {\n\t\tvar startbutton = document.getElementById('startbutton');\n\t\tstartbutton.value = \"start\";\n\t\tstartbutton.disabled = null;\n\t}\n\n\tstatic adjustVideoProportions() {\n\t\t// resize overlay and video if proportions are different\n\t\t// keep same height, just change width\n\t\tvar proportion = vid.videoWidth / vid.videoHeight;\n\t\tvid_width = Math.round(vid_height * proportion);\n\t\tvid.width = vid_width;\n\t\toverlay.width = vid_width;\n\t}\n\n\tstatic gumSuccess(stream) {\n\t\t// add camera stream if getUserMedia succeeded\n\t\tif (\"srcObject\" in vid) {\n\t\t\tvid.srcObject = stream;\n\t\t} else {\n\t\t\tvid.src = (window.URL && window.URL.createObjectURL(stream));\n\t\t}\n\t\tvid.onloadedmetadata = function () {\n\t\t\tctx.adjustVideoProportions();\n\t\t\tvid.play();\n\t\t}\n\t\tvid.onresize = function () {\n\t\t\tctx.adjustVideoProportions();\n\t\t\tif (trackingStarted) {\n\t\t\t\tctrack.stop();\n\t\t\t\tctrack.reset();\n\t\t\t\tctrack.start(vid);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic gumFail() {\n\t\talert(\"There was some problem trying to fetch video from your webcam. If you have a webcam, please make sure to accept when the browser asks for access to your webcam.\");\n\t}\n\t\n\tstatic mediaCheck() {\n\t\tnavigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n\t\twindow.URL = window.URL || window.webkitURL || window.msURL || window.mozURL;\n\t\t\n\t\t// check for camerasupport\n\t\tif (navigator.mediaDevices) {\n\t\t\tnavigator.mediaDevices.getUserMedia({\n\t\t\t\tvideo: true\n\t\t\t}).then(this.gumSuccess).catch(this.gumFail);\n\t\t} else if (navigator.getUserMedia) {\n\t\t\tnavigator.getUserMedia({\n\t\t\t\tvideo: true\n\t\t\t}, this.gumSuccess, this.gumFail);\n\t\t} else {\n\t\t\talert(\"This demo depends on getUserMedia, which your browser does not seem to support. :(\");\n\t\t}\n\t\t\n\t\tvid.addEventListener('canplay', this.enablestart, false);\n\t}\n\n\t/*********** setup of emotion detection *************/\n\tstatic reguliseEyebrows() {\n\t\t// set eigenvector 9 and 11 to not be regularized. This is to better detect motion of the eyebrows\n\t\tpModel.shapeModel.nonRegularizedVectors.push(9);\n\t\tpModel.shapeModel.nonRegularizedVectors.push(11);\n\t\tctrack = new clm.tracker({\n\t\t\tuseWebGL: true\n\t\t});\n\t\tctrack.init(pModel);\n\t\ttrackingStarted = false;\n\t}\n\n\n\tstatic drawLoop() {\n\t\trequestAnimationFrame(ctx.drawLoop);\n\t\toverlayCC.clearRect(0, 0, vid_width, vid_height);\n\t\t//psrElement.innerHTML = \"score :\" + ctrack.getScore().toFixed(4);\n\t\tif (ctrack.getCurrentPosition()) {\n\t\t\tctrack.draw(overlay);\n\t\t}\n\t\tvar cp = ctrack.getCurrentParameters();\n\t\tvar er = ec.meanPredict(cp);\n\t\n\t\tif (er) {\n\t\t\tconsole.log(er);\n\t\t\tctx.updateData(er);\n\t\t\tfor (var i = 0; i < er.length; i++) {\n\t\t\t\tif (er[i].value > 0.4) {\n\t\t\t\t\tdocument.getElementById('icon' + (i + 1)).style.visibility = 'visible';\n\t\t\t\t} else {\n\t\t\t\t\tdocument.getElementById('icon' + (i + 1)).style.visibility = 'hidden';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic startVideo() {\n\t\t// start video\n\t\tvid.play();\n\t\t// start tracking\n\t\tctrack.start(vid);\n\t\ttrackingStarted = true;\n\n\t\t// start loop to draw face\n\t\tthis.drawLoop();\n\t}\n\n\tstatic d3Vis() {\n\t\tvar barWidth = 30;\n\t\tvar formatPercent = d3.format(\".0%\");\n\t\tvar x = d3.scale.linear()\n\t\t\t.domain([0, Clam.getEmotions().length]).range([margin.left, width + margin.left]);\n\t\tvar y = d3.scale.linear()\n\t\t\t.domain([0, 1]).range([0, height]);\n\t\tsvg = d3.select(\"#emotion_chart\").append(\"svg\")\n\t\t\t.attr(\"width\", width + margin.left + margin.right)\n\t\t\t.attr(\"height\", height + margin.top + margin.bottom)\n\t\tsvg.selectAll(\"rect\").\n\t\tdata(emotionData).\n\t\tenter().\n\t\tappend(\"svg:rect\").\n\t\tattr(\"x\", function (datum, index) {\n\t\t\treturn x(index);\n\t\t}).\n\t\tattr(\"y\", function (datum) {\n\t\t\treturn height - y(datum.value);\n\t\t}).\n\t\tattr(\"height\", function (datum) {\n\t\t\treturn y(datum.value);\n\t\t}).\n\t\tattr(\"width\", barWidth).\n\t\tattr(\"fill\", \"#2d578b\");\n\t\tsvg.selectAll(\"text.labels\").\n\t\tdata(emotionData).\n\t\tenter().\n\t\tappend(\"svg:text\").\n\t\tattr(\"x\", function (datum, index) {\n\t\t\treturn x(index) + barWidth;\n\t\t}).\n\t\tattr(\"y\", function (datum) {\n\t\t\treturn height - y(datum.value);\n\t\t}).\n\t\tattr(\"dx\", -barWidth / 2).\n\t\tattr(\"dy\", \"1.2em\").\n\t\tattr(\"text-anchor\", \"middle\").\n\t\ttext(function (datum) {\n\t\t\treturn datum.value;\n\t\t}).\n\t\tattr(\"fill\", \"white\").\n\t\tattr(\"class\", \"labels\");\n\t\tsvg.selectAll(\"text.yAxis\").\n\t\tdata(emotionData).\n\t\tenter().append(\"svg:text\").\n\t\tattr(\"x\", function (datum, index) {\n\t\t\treturn x(index) + barWidth;\n\t\t}).\n\t\tattr(\"y\", height).\n\t\tattr(\"dx\", -barWidth / 2).\n\t\tattr(\"text-anchor\", \"middle\").\n\t\tattr(\"style\", \"font-size: 12\").\n\t\ttext(function (datum) {\n\t\t\treturn datum.emotion;\n\t\t}).\n\t\tattr(\"transform\", \"translate(0, 18)\").\n\t\tattr(\"class\", \"yAxis\");\n\n\t}\n\n\tstatic updateData(data) {\n\t\tvar y = d3.scale.linear()\n\t\t\t.domain([0, 1]).range([0, height]);\n\n\t\t// update\n\t\tif (!svg) { return; }\n\t\tvar rects = svg.selectAll(\"rect\")\n\t\t\t.data(data)\n\t\t\t.attr(\"y\", function (datum) {\n\t\t\t\treturn height - y(datum.value);\n\t\t\t})\n\t\t\t.attr(\"height\", function (datum) {\n\t\t\t\treturn y(datum.value);\n\t\t\t});\n\t\tvar texts = svg.selectAll(\"text.labels\")\n\t\t\t.data(data)\n\t\t\t.attr(\"y\", function (datum) {\n\t\t\t\treturn height - y(datum.value);\n\t\t\t})\n\t\t\t.text(function (datum) {\n\t\t\t\treturn datum.value.toFixed(1);\n\t\t\t});\n\t\t// enter\n\t\trects.enter().append(\"svg:rect\");\n\t\ttexts.enter().append(\"svg:text\");\n\t\t// exit\n\t\trects.exit().remove();\n\t\ttexts.exit().remove();\n\t}\n}","import Clam from './clmtracker';\n\n// console.log(Clam.init());\nClam.init();\n\ndocument.getElementById('startbutton').addEventListener('click', function () {\n\tClam.startVideo();\n});\n\n\n// /************ d3 code for barchart *****************/\n// var emotionData = Clam.getEmotionData();\n\n// var margin = {\n// \t\ttop: 20,\n// \t\tright: 20,\n// \t\tbottom: 10,\n// \t\tleft: 40\n// \t},\n// \twidth = 400 - margin.left - margin.right,\n// \theight = 100 - margin.top - margin.bottom;\n// var barWidth = 30;\n// var formatPercent = d3.format(\".0%\");\n// var x = d3.scale.linear()\n// \t.domain([0, Clam.getEmotions().length]).range([margin.left, width + margin.left]);\n// var y = d3.scale.linear()\n// \t.domain([0, 1]).range([0, height]);\n// var svg = d3.select(\"#emotion_chart\").append(\"svg\")\n// \t.attr(\"width\", width + margin.left + margin.right)\n// \t.attr(\"height\", height + margin.top + margin.bottom)\n// svg.selectAll(\"rect\").\n// data(emotionData).\n// enter().\n// append(\"svg:rect\").\n// attr(\"x\", function (datum, index) {\n// \treturn x(index);\n// }).\n// attr(\"y\", function (datum) {\n// \treturn height - y(datum.value);\n// }).\n// attr(\"height\", function (datum) {\n// \treturn y(datum.value);\n// }).\n// attr(\"width\", barWidth).\n// attr(\"fill\", \"#2d578b\");\n// svg.selectAll(\"text.labels\").\n// data(emotionData).\n// enter().\n// append(\"svg:text\").\n// attr(\"x\", function (datum, index) {\n// \treturn x(index) + barWidth;\n// }).\n// attr(\"y\", function (datum) {\n// \treturn height - y(datum.value);\n// }).\n// attr(\"dx\", -barWidth / 2).\n// attr(\"dy\", \"1.2em\").\n// attr(\"text-anchor\", \"middle\").\n// text(function (datum) {\n// \treturn datum.value;\n// }).\n// attr(\"fill\", \"white\").\n// attr(\"class\", \"labels\");\n// svg.selectAll(\"text.yAxis\").\n// data(emotionData).\n// enter().append(\"svg:text\").\n// attr(\"x\", function (datum, index) {\n// \treturn x(index) + barWidth;\n// }).\n// attr(\"y\", height).\n// attr(\"dx\", -barWidth / 2).\n// attr(\"text-anchor\", \"middle\").\n// attr(\"style\", \"font-size: 12\").\n// text(function (datum) {\n// \treturn datum.emotion;\n// }).\n// attr(\"transform\", \"translate(0, 18)\").\n// attr(\"class\", \"yAxis\");\n\n// function updateData(data) {\n// \t// update\n// \tvar rects = svg.selectAll(\"rect\")\n// \t\t.data(data)\n// \t\t.attr(\"y\", function (datum) {\n// \t\t\treturn height - y(datum.value);\n// \t\t})\n// \t\t.attr(\"height\", function (datum) {\n// \t\t\treturn y(datum.value);\n// \t\t});\n// \tvar texts = svg.selectAll(\"text.labels\")\n// \t\t.data(data)\n// \t\t.attr(\"y\", function (datum) {\n// \t\t\treturn height - y(datum.value);\n// \t\t})\n// \t\t.text(function (datum) {\n// \t\t\treturn datum.value.toFixed(1);\n// \t\t});\n// \t// enter\n// \trects.enter().append(\"svg:rect\");\n// \ttexts.enter().append(\"svg:text\");\n// \t// exit\n// \trects.exit().remove();\n// \ttexts.exit().remove();\n// }","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;"],"sourceRoot":""}